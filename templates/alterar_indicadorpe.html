{% extends 'basecord.html' %}

{% block titulo %}
  Planejamento Estratégico - Alterar Valor do Indicador
{% endblock %}

{% block conteudo %}
<body>
  <h1 style="text-align: center; color: darkblue;">Alterar Indicador</h1>
  
  <!-- Exibir mensagens flash -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="container mt-3">
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <form action="{{ url_for('planejamento.alterar_indicadorpe', indicador_id=indicador.id) }}" method="POST" style="text-align: center;">
    <div class="form-group">
      <label for="nome">Nome do Indicador:</label><br>
      <input type="text" id="nome" name="nome" value="{{ indicador.nome }}" required style="width: 80%; margin-bottom: 10px;"><br>
    </div>

    <div class="form-group">
      <label for="descricao">Descrição:</label><br>
      <input type="text" id="descricao" name="descricao" value="{{ indicador.descricao }}" required style="width: 80%; margin-bottom: 10px;"><br>
    </div>

    <div class="form-group">
      <label for="frequencia_coleta">Frequência de Coleta:</label><br>
      <select id="frequencia_coleta" name="frequencia_coleta" required style="width: 80%; margin-bottom: 10px;">
        <option value="diário" {% if indicador.frequencia_coleta == 'diário' %}selected{% endif %}>Diário</option>
        <option value="semanal" {% if indicador.frequencia_coleta == 'semanal' %}selected{% endif %}>Semanal</option>
        <option value="mensal" {% if indicador.frequencia_coleta == 'mensal' %}selected{% endif %}>Mensal</option>
        <option value="trimestral" {% if indicador.frequencia_coleta == 'trimestral' %}selected{% endif %}>Trimestral</option>
        <option value="semestral" {% if indicador.frequencia_coleta == 'semestral' %}selected{% endif %}>Semestral</option>
        <option value="anual" {% if indicador.frequencia_coleta == 'anual' %}selected{% endif %}>Anual</option>
        <option value="quadrienal" {% if indicador.frequencia_coleta == 'quadrienal' %}selected{% endif %}>Quadrienal</option>
      </select><br>
    </div>

    <div class="form-group">
      <label for="peso">Peso:</label><br>
      <input type="number" id="peso" name="peso" value="{{ indicador.peso }}" required style="width: 80%; margin-bottom: 10px;" step="0.01"><br>
    </div>

    <div class="form-group">
      <label for="valor_meta">Valor Meta:</label><br>
      <input type="number" id="valor_meta" name="valor_meta" value="{{ indicador.valor_meta }}" required style="width: 80%; margin-bottom: 10px;" step="0.01"><br>
    </div>

    {% for valorindicador in valores_indicadores %}
    <div class="form-group" style="display: flex; justify-content: center; gap: 10px;">
      <div>
        <label for="semestre{{ loop.index }}">Semestre:</label><br>
        <input type="number" id="semestre{{ loop.index }}" name="semestres[]" value="{{ valorindicador.semestre }}" required class="no-arrow" style="width: 100px; margin-bottom: 10px;">
      </div>
      <div>
        <label for="ano{{ loop.index }}">Ano:</label><br>
        <input type="number" id="ano{{ loop.index }}" name="anos[]" value="{{ valorindicador.ano }}" required class="no-arrow" style="width: 100px; margin-bottom: 10px;">
      </div>
      <div>
        <label for="valor{{ loop.index }}">Valor:</label><br>
        <input type="text" id="valor{{ loop.index }}" name="valores[]" value="{{ valorindicador.valor }}" required style="width: 100px; margin-bottom: 10px;">
      </div>
    </div>
    {% endfor %}
    
    <div>
      <button type="submit" style="background-color: darkblue; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer;">Salvar</button>
      <button type="button" onclick="fechar()" style="background-color: #f44336; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin-left: 10px;">Fechar</button>
    </div>
  </form>

  <style>
    /* Remover setas dos campos de número */
    input[type=number]::-webkit-outer-spin-button,
    input[type=number]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    
    input[type=number] {
      -moz-appearance: textfield;
    }
  </style>

  <script>
    function fechar() {
        window.location.href = "{{ url_for('planejamento.associar_indicadorespe') }}";
    }
  </script>
</body>
{% endblock %}